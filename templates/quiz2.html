<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Quiz</title>

        <link
            href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.1.1/flowbite.min.css"
            rel="stylesheet" />

        <script>
        
        document.addEventListener('DOMContentLoaded', (event) => {
            loadNextQuestion();
        });

        function loadNextQuestion(selectedAnswer = null) {
            fetch('/get_next_question', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    selected_answer: selectedAnswer,
                    answered_question: document.getElementById('questionIDLabel').innerHTML
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    // alert('No more questions');
                    window.location.href = '/dashboard';
                } else {
                    console.log("attempting to update question image");
                    // currentQuestionIndex++;
                    console.log(data.question);
                    updateQuestionImage(data.question);

                    //replace mutliple choice with free response box if freeResponse == true
                }
            })
            .catch(error => {
                console.error('Error:', error);
            });

        }

        function updateQuestionImage(question_id) {
            document.getElementById('questionIDLabel').textContent = question_id;
            question_id = question_id + '.png';
            const imageUrl = "{{ url_for('get_image', image_name='') }}" + question_id;
            console.log('Image URL:', imageUrl)
            document.getElementById('question-image').src = imageUrl;
        }
    </script>
    </head>

    <header>
        {% include 'nav.html' %}
    </header>
    <body>
        <div id="question-container" class="flex flex-col justify-center items-center">
            <h1 class="text-lg">Question ID: <span class="font-semibold" id="questionIDLabel">Loading...</span></h1>
            <img id="question-image" src alt="Question Image">
            <!-- <img id="question-image" src="{{ url_for('get_image', image_name=image_name) }}" alt="Image"> -->

            <!-- <p> {{ url_for('get_image', image_name='') + '1dc74ae7' }}</p>
        <img src="{{ url_for('get_image', image_name='1dc74ae7.png') }}" alt="Image"> -->

            <div class="pt-5" id="answers">
                <button class="mx-4 rounded-md border px-5 py-3" onclick="loadNextQuestion('A')">A</button>
                <button class="mx-4 rounded-md border px-5 py-3" onclick="loadNextQuestion('B')">B</button>
                <button class="mx-4 rounded-md border px-5 py-3" onclick="loadNextQuestion('C')">C</button>
                <button class="mx-4 rounded-md border px-5 py-3" onclick="loadNextQuestion('D')">D</button>
            </div>
        </div>

        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.3.0/flowbite.min.js"></script>

    </body>
</html>
